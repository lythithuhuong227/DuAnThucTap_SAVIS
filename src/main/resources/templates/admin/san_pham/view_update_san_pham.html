<!DOCTYPE html>
<html lang="en"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/fragments_layout_admin}"
      xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="container" layout:fragment="content">


    <h2 class="text-center mb-4">Update Sản Phẩm</h2>
    <form action="/admin/psg/chi-tiet-san-pham/update-san-pham" method="post" enctype="multipart/form-data" th:object="${sanPham}"
          onsubmit="return confirm('Bạn có cập nhật không?')" >
        <input type="hidden" th:field="*{id}">
        <input type="hidden" th:field="*{ngayTao}">
        <input type="hidden" th:field="*{ma}">
        <div class="card card-custom">
            <div class="card-header flex-wrap border-0 pt-6 pb-0">
                <div class="row">
                    <div class="col-9">
                        <div class="form-group mb-3">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Tên Sản Phẩm</label>
                            <input class="form-control custom-shadow custom-radius border-1 bg-white"
                                   type="text" placeholder="Nhập tên sản phẩm" th:field="*{ten}"
                                   style="height: 50px">
                            <span th:if="${#fields.hasErrors('ten')}" style="color: red; font-size: 15px"
                                  th:errors="*{ten}"></span>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="form-group mb-3">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Mã Vạch</label>
                            <input class="form-control custom-shadow custom-radius border-1 bg-white"
                                   type="text" placeholder="Nhập mã vạch sản phẩm" th:field="*{maVach}"
                                   style="height: 50px">
                            <span th:if="${#fields.hasErrors('maVach')}" style="color: red; font-size: 15px"
                                  th:errors="*{maVach}"></span>
                        </div>
                    </div>
                </div>
                <div class="form-group mb-3">
                    <label class="form-label" style="margin-left: 10px;font-size: 14px">Mô Tả Sản Phẩm</label>
                    <input class="form-control custom-shadow custom-radius border-1 bg-white"
                           type="text" placeholder="Nhập mô tả sản phẩm" th:field="*{moTa}"
                           style="height: 80px">
                    <span th:if="${#fields.hasErrors('moTa')}" style="color: red; font-size: 15px"
                          th:errors="*{moTa}"></span>
                </div>
                <div class="row">
                    <div class="col-3">
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Năm Sản Xuất</label>
                            <input class="form-control custom-shadow custom-radius border-1 bg-white"
                                   type="date" placeholder="Nhập năm sản xuất" th:field="*{namSanXuat}"
                                   style="height: 40px">
                            <span th:if="${#fields.hasErrors('namSanXuat')}" style="color: red; font-size: 15px"
                                  th:errors="*{namSanXuat}"></span>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Cổ Áo</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{coAo}">
                                    <option th:each="ca:${listCoAo}" th:value="${ca.id}" th:text="${ca.ten}"
                                    ></option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Dòng Sản Phẩm</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{dongSanPham}"
                                >
                                    <option th:each="dsp:${listDongSanPham}" th:value="${dsp.id}" th:text="${dsp.ten}"
                                    ></option>
                                </select>
                            </div>
                        </div>

                    </div>
                    <div class="col-3">
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Giá</label>
                            <div class="form-group mb-3">
                                <input class="form-control custom-shadow custom-radius border-1 bg-white"
                                       type="number" placeholder="Nhập giá sản phẩm" th:field="*{gia}"
                                       style="height: 40px">
                                <span th:if="${#fields.hasErrors('gia')}" style="color: red; font-size: 15px"
                                      th:errors="*{gia}"></span>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Màu Sắc</label>
                            <div class="customize-input d-flex">
                                <select class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{mauSac}"
                                >
                                    <option th:each="ms:${listMauSac}" th:value="${ms.id}" th:text="${ms.ten}"></option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Loại Sản Phẩm</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{loaiSanPham}"
                                >
                                    <option th:each="lsp:${listLoaiSanPham}" th:value="${lsp.id}" th:text="${lsp.ten}"
                                    ></option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Công Nghệ</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{congNghe}"
                                >
                                    <option th:each="cn:${listCongNghe}" th:value="${cn.id}" th:text="${cn.ten}"
                                    ></option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Chất Liệu </label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{chatLieu}"
                                >
                                    <option th:each="cl:${listChatLieu}" th:value="${cl.id}"
                                            th:text="${cl.ten}"></option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Nhà Sản Xuất</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{nhaSanXuat}"
                                >
                                    <option th:each="nsx:${listNhaSanXuat}" th:value="${nsx.id}"
                                            th:text="${nsx.ten}"></option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Cầu Thủ</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px" th:field="*{cauThu}"
                                >
                                    <option th:each="ct:${listCauThu}" th:value="${ct.id}" th:text="${ct.ten}"></option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Thương Hiệu</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{thuongHieu}"
                                >
                                    <option th:each="th:${listThuongHieu}" th:value="${th.id}"
                                            th:text="${th.ten}"></option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group mb-4">
                            <label class="form-label" style="margin-left: 10px;font-size: 14px">Nước Sản Xuất</label>
                            <div class="customize-input d-flex">
                                <select
                                        class="custom-select form-control bg-white custom-radius custom-shadow border-1"
                                        style="height: 40px;width: 300px; font-size: 13px"
                                        th:field="*{nuocSanXuat}"
                                >
                                    <option th:each="nuoc:${listNuocSanXuat}" th:value="${nuoc.id}"
                                            th:text="${nuoc.ten}"></option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card card-custom">
            <div class="card-header flex-wrap border-0 pt-6 pb-0">
                <div class="form-group mb-3">
                    <div>
                        <label class="form-label" style="margin-left: 10px; font-size: 14px">Images loader</label>
                    </div>
                    <input type="file" class="form-control custom-shadow custom-radius border-1 bg-white mb-4" id="filesAnhSanPham" name="image" aria-describedby="inputGroupFileAddon04" aria-label="Upload"  multiple>
                    <div id="previewImages" class="d-flex w-150px h-150px">

                    <div id="image-preview-container">
                        <label class="check" th:each="aSp : ${listAnhSanPham}">
                            <img th:src="@{'/admin/psg/chi-tiet-san-pham/anhSp?idSp=' + ${aSp.id}}" alt="Image" id="image-preview-[[${aSp.id}]]" style="width: 150px; height: 150px; border-radius: 10%; margin-right: 25px; display: inline-block;" />
                        </label>
                    </div>
                    </div>
            </div>
        </div>
        </div>
        <div class="form-group mb-3 text-center">
            <button class="btn waves-effect waves-light btn-rounded btn-outline-info" type="submit">Save</button>
        </div>
    </form>
    <div class="card card-custom">
        <div class="card-header flex-wrap border-0 pt-6 pb-0">
            <div class="row">
                <form action="/admin/psg/chi-tiet-san-pham/insert-chi-tiet-san-pham" method="post">
                <div class="col-3">
                    <label class="form-label" style="margin-left: 10px;font-size: 14px">Kích Thước</label>
                </div>
                <div class="col-9">
                    <div class="form-group mb-3">
                        <label class="check" th:each="kt:${listKichThuoc}"
                               style="margin-right: 15px;margin-top: 15px">
                            <input type="hidden" th:name="idSP" th:value="${sanPham.id}"/>
                            <input type="checkbox" th:name="kichThuoc" th:value="${kt.id}"/>
                            <span th:text="${kt.ten}"></span>
                        </label>
                    </div>
                </div>
                    <div class="form-group mb-3 text-center">
                        <button class="btn waves-effect waves-light btn-rounded btn-outline-info" type="submit">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <div class="card card-custom">
        <div class="card-header flex-wrap border-0 pt-6 pb-0">
            <div class="form-group mb-3">
                <form action="/admin/psg/chi-tiet-san-pham/update-so-luong-active" method="post" id="updateForm"
                      onsubmit="return confirm('Bạn có cập nhập không?')">
                    <table class="table">
                        <thead>
                        <tr>
                            <th scope="col">STT</th>
                            <th scope="col">Tên Sản Phẩm</th>
                            <th scope="col">Kích Thước</th>
                            <th scope="col">Số Lượng</th>
                        </tr>
                        </thead>
                        <tbody>

                        <tr th:each="ctsp, index : ${listCtspActive}">
                            <td th:text="${index.count}"></td>
                            <td th:text="${ctsp.sanPham.ten}"></td>
                            <td th:text="${ctsp.kichThuoc.ten}"></td>
                            <td>
                                <input type="hidden" name="ids" th:value="${ctsp.id}"/>
                                <input type="number" class="form-control border-1 bg-white" name="soLuongs"
                                       th:value="${ctsp.soLuong}" style="height: 35px"/>
                            </td>
<!--                            <td>-->

<!--                                <a th:href="@{/admin/psg/chi-tiet-san-pham/delete-ctsp-update/{id}(id=${ctsp.id})}"-->
<!--                                   class="btn waves-effect waves-light btn-rounded btn-danger">Xóa</a>-->
<!--                            </td>-->
                        </tr>
                        </tbody>
                    </table>
                    <div class="form-group mb-3 text-center">
                        <button class="btn waves-effect waves-light btn-rounded btn-outline-info" type="submit">Save
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script th:inline="javascript">
    function updateSoLuong() {
        var ids = [];
        var soLuongs = [];
        var rows = document.getElementsByTagName("tr");
        for (var i = 0; i < rows.length; i++) {
            var row = rows[i];
            var idInput = row.querySelector("input[name='ids']");
            var soLuongInput = row.querySelector("input[name='soLuongs']");
            if (idInput && soLuongInput) {
                ids.push(idInput.value);
                soLuongs.push(soLuongInput.value);
            }
        }
        document.getElementById("updateForm").action = "/update-so-luong-active?ids=" + ids.join(",") + "&soLuongs=" + soLuongs.join(",");
        document.getElementById("updateForm").submit();
    }
</script>
</body>
</html>